# Solar EPC Pro

## Current State
- QuotationsPage shows a table of quotations (proposalNumber, clientName, companyName, totalCost, annualSavings, paybackYears, irr, status) with a company letterhead banner at the top
- No PDF export button exists anywhere on the page
- Company profile (logo, companyName, companyAddress, gstNumber) is stored in localStorage via useCompanyProfile hook
- Quotation data model: id, proposalNumber, clientName, companyName, gst, totalCost, subsidy, paybackYears, annualSavings, irr, carbonSavings, status, termsAndConditions
- MOQ items available per project via listMOQ(projectId) — but quotation does not store a projectId linkage
- Projects store: clientName, systemSizeKW, systemType, installationType, batteryCapacityKWh

## Requested Changes (Diff)

### Add
- Per-row "Export PDF" button in the quotations table (a download icon button in each row)
- A client-ready PDF proposal generated in the browser using jsPDF + jspdf-autotable (no server needed)
- PDF structure (formal, styled, letterhead):
  1. **Header / Letterhead** -- Company logo (if set), company name, address, GSTIN; proposal number + date on right side
  2. **Client Details section** -- Client name, site address (from quotation clientName + companyName fields), contact placeholder
  3. **System Summary section** -- System size (kW), system type (On-Grid / Off-Grid / Hybrid), installation type, battery capacity (kWh), tariff/rate, total project cost (₹), subsidy (₹), net investment (₹)
  4. **Detailed BOM / MOQ table** -- Fetches MOQ items for the matching project (matched by clientName). Columns: #, Item Name, Category, Brand, Qty, Unit, Unit Price (₹), Total (₹). Grouped by category with subtotals. Grand total row.
  5. **ROI Summary table** -- Numbers only (no chart). Rows: Total Project Cost, Subsidy, Net Investment, Annual Energy Savings (₹), Payback Period (yrs), IRR (%), 25-Year Net Savings (₹), Carbon Offset (tonnes/yr)
  6. **Terms & Conditions section** -- From quotation.termsAndConditions field
  7. **Footer** -- Page number, "Generated by Solar EPC Pro" tagline
- Since Quotation does not have a projectId field, match project by clientName equality to get MOQ items for the BOM section
- If no MOQ items are found for the client, the BOM section shows a note "MOQ not yet generated for this project"
- PDF uses navy blue (#1e3a5f) as primary header/accent color, solar yellow (#f5a623) for section dividers, white background

### Modify
- QuotationsPage: add an "Export PDF" icon button (Download icon) to each row in the actions column
- Add jsPDF and jspdf-autotable as frontend dependencies

### Remove
- Nothing removed

## Implementation Plan
1. Install jsPDF and jspdf-autotable npm packages in the frontend
2. Create a new utility file `src/frontend/src/utils/exportQuotationPDF.ts` that:
   - Accepts quotation data, company profile, projects list, and MOQ items map
   - Builds the full PDF document using jsPDF with the sections described above
   - Triggers browser download of the PDF
3. Update QuotationsPage.tsx:
   - Add a useProjects() query to get all projects
   - For each project, load MOQ items lazily (or pass a callback that fetches on demand)
   - Add an "Export PDF" button per row that calls the export utility with the row's quotation + company profile + matching project + its MOQ items
   - Show a brief loading spinner on the button while MOQ is being fetched
4. Verify typecheck and build pass cleanly
